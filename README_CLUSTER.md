# Playwright MCP é›†ç¾¤ç®¡ç†è¯¦ç»†æ–‡æ¡£

## ğŸ¯ æ¦‚è¿°

æœ¬æ–‡æ¡£è¯¦ç»†ä»‹ç» Playwright MCP é›†ç¾¤ç‰ˆçš„é«˜çº§åŠŸèƒ½ï¼ŒåŒ…æ‹¬é›†ç¾¤ç®¡ç†ã€éš”ç¦»æ¨¡å¼ã€Dockeréƒ¨ç½²å’Œå®Œæ•´çš„æµ‹è¯•å¥—ä»¶ã€‚

## ğŸ—ï¸ æ¶æ„è®¾è®¡

### é›†ç¾¤æ¶æ„å›¾
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    MCP Client (LLM)                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚               â”‚               â”‚
â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”
â”‚ Instance 1â”‚   â”‚ Instance 2â”‚   â”‚ Instance 3â”‚
â”‚Port: 9001 â”‚   â”‚Port: 9002 â”‚   â”‚Port: 9003 â”‚
â”‚Profile: A â”‚   â”‚Profile: B â”‚   â”‚Profile: C â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### éš”ç¦»æ¨¡å¼åŸç†
æ¯ä¸ªå®ä¾‹è¿è¡Œåœ¨ç‹¬ç«‹çš„æµè§ˆå™¨é…ç½®æ–‡ä»¶ä¸­ï¼š
- **æœ¬åœ°æ¨¡å¼**: æ¯ä¸ªå®ä¾‹ä½¿ç”¨ä¸åŒçš„ `USER_DATA_DIR`
- **Dockeræ¨¡å¼**: æ¯ä¸ªå®¹å™¨ä½¿ç”¨ç‹¬ç«‹çš„ç¯å¢ƒå˜é‡
- **å†…å­˜éš”ç¦»**: ä¼šè¯æ•°æ®å®Œå…¨åˆ†ç¦»ï¼Œæ— ç›¸äº’å¹²æ‰°

## ğŸ“‹ ç®¡ç†è„šæœ¬è¯¦è§£

### start.sh - é›†ç¾¤å¯åŠ¨è„šæœ¬

#### åŠŸèƒ½ç‰¹æ€§
- **æ™ºèƒ½æ¨¡å¼æ£€æµ‹**: è‡ªåŠ¨é€‰æ‹©æœ¬åœ°æˆ–Dockeréƒ¨ç½²æ¨¡å¼
- **éš”ç¦»æ¨¡å¼**: é»˜è®¤å¯ç”¨ï¼Œé¿å…å®ä¾‹é—´é…ç½®å†²çª
- **ç«¯å£ç®¡ç†**: è‡ªåŠ¨æ£€æµ‹å’Œé‡Šæ”¾å ç”¨ç«¯å£
- **å¥åº·æ£€æŸ¥**: å¤šå±‚éªŒè¯ç¡®ä¿å®ä¾‹æ­£å¸¸å¯åŠ¨
- **è¯¦ç»†æ—¥å¿—**: å®Œæ•´çš„å¯åŠ¨è¿‡ç¨‹è®°å½•å’Œé”™è¯¯è¯Šæ–­

#### ä½¿ç”¨ç¤ºä¾‹
```bash
# åŸºç¡€å¯åŠ¨ï¼ˆæœ¬åœ°æ¨¡å¼ï¼Œéš”ç¦»å¯ç”¨ï¼‰
./start.sh

# Dockeræ¨¡å¼å¯åŠ¨
./start.sh --docker

# è‡ªå®šä¹‰é…ç½®æ–‡ä»¶
./start.sh --config my_cluster.json

# ç¦ç”¨éš”ç¦»æ¨¡å¼ï¼ˆä¸æ¨èï¼‰
./start.sh --no-isolated

# æŸ¥çœ‹å¸®åŠ©
./start.sh --help
```

#### å¯åŠ¨æµç¨‹
1. **å‚æ•°è§£æ** â†’ å¤„ç†å‘½ä»¤è¡Œé€‰é¡¹
2. **é…ç½®éªŒè¯** â†’ æ£€æŸ¥é…ç½®æ–‡ä»¶æœ‰æ•ˆæ€§
3. **ç¯å¢ƒå‡†å¤‡** â†’ åˆ›å»ºå¿…è¦ç›®å½•ï¼Œæ¸…ç†æ—§è¿›ç¨‹
4. **å®ä¾‹å¯åŠ¨** â†’ æ ¹æ®é…ç½®é€ä¸€å¯åŠ¨å®ä¾‹
5. **å¥åº·æ£€æŸ¥** â†’ éªŒè¯æ‰€æœ‰å®ä¾‹è¿è¡ŒçŠ¶æ€
6. **ç»“æœæŠ¥å‘Š** â†’ è¾“å‡ºå¯åŠ¨ç»Ÿè®¡å’Œè®¿é—®ä¿¡æ¯

### stop.sh - æ™ºèƒ½åœæ­¢è„šæœ¬ ğŸ†•

#### é‡å¤§å‡çº§ç‰¹æ€§
- **ğŸ” æ··åˆç¯å¢ƒæ£€æµ‹**: è‡ªåŠ¨è¯†åˆ«æœ¬åœ°å’ŒDockerå®ä¾‹
- **ğŸ¯ é€‰æ‹©æ€§åœæ­¢**: æ”¯æŒæŒ‰ç±»å‹åœæ­¢ç‰¹å®šå®ä¾‹
- **ğŸ§¹ æ™ºèƒ½æ¸…ç†**: å½»åº•æ¸…ç†éš”ç¦»æ¨¡å¼äº§ç”Ÿçš„èµ„æº
- **ğŸ’ª å¼ºåˆ¶æ¨¡å¼**: åº”æ€¥æƒ…å†µä¸‹çš„å®Œå…¨æ¸…ç†
- **ğŸ“Š çŠ¶æ€éªŒè¯**: ç¡®ä¿åœæ­¢æ“ä½œçš„å®Œæ•´æ€§

#### ä½¿ç”¨ç¤ºä¾‹
```bash
# æ™ºèƒ½åœæ­¢æ‰€æœ‰å®ä¾‹ï¼ˆæ¨èï¼‰
./stop.sh

# ä»…åœæ­¢æœ¬åœ°å®ä¾‹
./stop.sh --local

# ä»…åœæ­¢Dockerå®ä¾‹
./stop.sh --docker

# å¼ºåˆ¶åœæ­¢å¹¶æ¸…ç†æ‰€æœ‰èµ„æº
./stop.sh --force

# æŸ¥çœ‹å¸®åŠ©
./stop.sh --help
```

#### åœæ­¢æœºåˆ¶
**æœ¬åœ°å®ä¾‹åœæ­¢**:
1. **PIDæ–‡ä»¶åœæ­¢** â†’ é€šè¿‡ä¿å­˜çš„è¿›ç¨‹IDä¼˜é›…åœæ­¢
2. **è¿›ç¨‹åç§°æ¸…ç†** â†’ æ¸…ç†æ®‹ç•™çš„ç›¸å…³è¿›ç¨‹
3. **ç«¯å£é‡Šæ”¾** â†’ å¼ºåˆ¶é‡Šæ”¾å ç”¨çš„ç«¯å£
4. **ä¸´æ—¶æ–‡ä»¶æ¸…ç†** â†’ åˆ é™¤éš”ç¦»æ¨¡å¼äº§ç”Ÿçš„ä¸´æ—¶æ–‡ä»¶

**Dockerå®ä¾‹åœæ­¢**:
1. **å®¹å™¨å‘ç°** â†’ è‡ªåŠ¨è¯†åˆ«æ‰€æœ‰MCPç›¸å…³å®¹å™¨
2. **ä¼˜é›…åœæ­¢** â†’ ä½¿ç”¨docker stopå‘½ä»¤åœæ­¢å®¹å™¨
3. **å®¹å™¨æ¸…ç†** â†’ è‡ªåŠ¨æ¸…ç†åœæ­¢çš„å®¹å™¨
4. **å¼ºåˆ¶æ¸…ç†** â†’ å¼ºåˆ¶æ¨¡å¼ä¸‹åˆ é™¤æ‰€æœ‰ç›¸å…³å®¹å™¨

#### å®é™…ä½¿ç”¨åœºæ™¯
```bash
# åœºæ™¯1: å¼€å‘è¿‡ç¨‹ä¸­å¿«é€Ÿé‡å¯
./stop.sh && ./start.sh

# åœºæ™¯2: åªé‡å¯Dockerå®ä¾‹
./stop.sh --docker && ./start.sh --docker

# åœºæ™¯3: åº”æ€¥æƒ…å†µå®Œå…¨æ¸…ç†
./stop.sh --force

# åœºæ™¯4: ç»´æŠ¤æ¨¡å¼ï¼ˆä¿ç•™æ—¥å¿—ï¼‰
./stop.sh --local

# åœºæ™¯5: æ£€æŸ¥è¿è¡ŒçŠ¶æ€
./stop.sh  # ä¼šæ˜¾ç¤ºå½“å‰è¿è¡Œçš„å®ä¾‹æ•°é‡
```

## ğŸ”§ é…ç½®æ–‡ä»¶è¯¦è§£

### cluster_config.json å®Œæ•´é…ç½®

```json
{
  "cluster": {
    "instances": [
      {
        "id": "mcp-1",                    // å®ä¾‹å”¯ä¸€æ ‡è¯†
        "port": 9001,                     // ç›‘å¬ç«¯å£
        "url": "http://localhost:9001/sse" // è®¿é—®URL
      },
      {
        "id": "mcp-2",
        "port": 9002,
        "url": "http://localhost:9002/sse"
      },
      {
        "id": "mcp-3",
        "port": 9003,
        "url": "http://localhost:9003/sse"
      },
      {
        "id": "mcp-4",
        "port": 9004,
        "url": "http://localhost:9004/sse"
      },
      {
        "id": "mcp-5",
        "port": 9005,
        "url": "http://localhost:9005/sse"
      }
    ],
    "max_concurrent_per_instance": 1,    // æ¯å®ä¾‹æœ€å¤§å¹¶å‘æ•°
    "health_check_interval": 10,         // å¥åº·æ£€æŸ¥é—´éš”(ç§’)  
    "max_retries": 3                     // æœ€å¤§é‡è¯•æ¬¡æ•°
  },
  "browser": {
    "headless": true,                    // æ— å¤´æ¨¡å¼
    "timeout": 30000,                    // è¶…æ—¶æ—¶é—´(æ¯«ç§’)
    "viewport": {                        // è§†çª—å¤§å°
      "width": 1280,
      "height": 720
    }
  },
  "network": {
    "timeout": 30,                       // ç½‘ç»œè¶…æ—¶
    "retry_attempts": 3,                 // é‡è¯•æ¬¡æ•°
    "retry_delay": 1                     // é‡è¯•å»¶è¿Ÿ(ç§’)
  },
  "logging": {
    "level": "INFO",                     // æ—¥å¿—çº§åˆ«
    "format": "%(asctime)s - %(name)s - %(levelname)s - %(message)s"
  }
}
```

### docker_cluster_config.json é…ç½®

```json
{
  "cluster": {
    "instances": [
      {
        "id": "docker-mcp-1",
        "port": 9001,
        "url": "http://localhost:9001/mcp"  // Dockerä½¿ç”¨/mcpç«¯ç‚¹
      },
      {
        "id": "docker-mcp-2", 
        "port": 9002,
        "url": "http://localhost:9002/mcp"
      },
      {
        "id": "docker-mcp-3",
        "port": 9003,
        "url": "http://localhost:9003/mcp"
      },
      {
        "id": "docker-mcp-4",
        "port": 9004,
        "url": "http://localhost:9004/mcp"
      },
      {
        "id": "docker-mcp-5",
        "port": 9005,
        "url": "http://localhost:9005/mcp"
      }
    ],
    "max_concurrent_per_instance": 1,
    "health_check_interval": 10,
    "max_retries": 3
  }
}
```

## ğŸ”’ éš”ç¦»æ¨¡å¼æ·±å…¥è§£æ

### éš”ç¦»æ¨¡å¼çš„ä¼˜åŠ¿
1. **å¹¶å‘å®‰å…¨**: é¿å…å¤šå®ä¾‹é—´çš„èµ„æºç«äº‰
2. **æ•°æ®éš”ç¦»**: æ¯ä¸ªå®ä¾‹çš„ä¼šè¯æ•°æ®å®Œå…¨ç‹¬ç«‹
3. **æ•…éšœéš”ç¦»**: å•ä¸ªå®ä¾‹å´©æºƒä¸å½±å“å…¶ä»–å®ä¾‹
4. **é…ç½®åˆ†ç¦»**: æµè§ˆå™¨è®¾ç½®å’Œæ’ä»¶ä¸ä¼šå†²çª

### éš”ç¦»å®ç°æœºåˆ¶

#### æœ¬åœ°æ¨¡å¼éš”ç¦»
```bash
# æ¯ä¸ªå®ä¾‹ä½¿ç”¨ç‹¬ç«‹çš„ç¯å¢ƒå˜é‡
export PLAYWRIGHT_BROWSERS_PATH="/home/user/.cache/ms-playwright-1"
export USER_DATA_DIR="/tmp/playwright-profile-1"

# å¯åŠ¨å‘½ä»¤åŒ…å«éš”ç¦»å‚æ•°
npx @playwright/mcp@latest --port 9001 --isolated
```

#### Dockeræ¨¡å¼éš”ç¦»
```bash
# æ¯ä¸ªå®¹å™¨ä½¿ç”¨ç‹¬ç«‹çš„ç¯å¢ƒå˜é‡å’ŒæŒ‚è½½ç›®å½•
docker run -d \
  --name mcp-instance-1 \
  -p 9001:9000 \
  -e USER_DATA_DIR="/tmp/playwright-1" \
  -e BROWSER_PROFILE_DIR="/tmp/browser-profile-1" \
  playwright-mcp --port 9000 --isolated
```

## ğŸ§ª æµ‹è¯•å¥—ä»¶è¯¦è§£

### 1. test_all_tools_chinese.py - å…¨å·¥å…·æµ‹è¯•

**åŠŸèƒ½**: ä½¿ç”¨å›½å†…ç½‘ç«™æµ‹è¯•æ‰€æœ‰25ä¸ªå·¥å…·
**ç‰¹è‰²**: 
- æ”¯æŒ5ä¸ªä¸»æµå›½å†…ç½‘ç«™è½®æ¢æµ‹è¯•
- æŒ‰åŠŸèƒ½åˆ†ç±»ç»Ÿè®¡æˆåŠŸç‡
- è¯¦ç»†çš„é”™è¯¯æŠ¥å‘Šå’Œè°ƒè¯•ä¿¡æ¯

**æµ‹è¯•ç½‘ç«™**:
- ç™¾åº¦ (https://www.baidu.com) - æœç´¢å¼•æ“
- è…¾è®¯ (https://www.qq.com) - é—¨æˆ·ç½‘ç«™
- æ·˜å® (https://www.taobao.com) - ç”µå•†å¹³å°
- äº¬ä¸œ (https://www.jd.com) - ç”µå•†å¹³å°
- å“”å“©å“”å“© (https://www.bilibili.com) - è§†é¢‘ç½‘ç«™

**æµ‹è¯•åˆ†ç±»**:
```
å¯¼èˆªæ§åˆ¶: browser_navigate, browser_navigate_back, browser_navigate_forward
é¡µé¢æ“ä½œ: browser_click, browser_type, browser_scroll, browser_hover, browser_drag
é¡µé¢ç®¡ç†: browser_new_page, browser_close_page, browser_close
æ ‡ç­¾é¡µç®¡ç†: browser_tab_list, browser_tab_new, browser_tab_select, browser_tab_close
å†…å®¹è·å–: browser_snapshot, browser_take_screenshot, browser_get_page_content, browser_pdf_save
ç½‘ç»œç›‘æ§: browser_network_requests, browser_console_messages
çª—å£æ§åˆ¶: browser_resize, browser_press_key
é«˜çº§åŠŸèƒ½: browser_evaluate, browser_wait_for, browser_select_option
ç³»ç»ŸåŠŸèƒ½: browser_install, browser_handle_dialog, browser_file_upload, browser_generate_playwright_test
```

### 2. test_cluster_management.py - é›†ç¾¤ç®¡ç†æµ‹è¯•

**åŠŸèƒ½**: æµ‹è¯•é›†ç¾¤çš„ç®¡ç†å’Œè°ƒåº¦åŠŸèƒ½
**åŒ…å«**:
- è¿æ¥æµ‹è¯•å’Œå·¥å…·å‘ç°
- é›†ç¾¤å¥åº·æ£€æŸ¥
- ä»»åŠ¡è°ƒåº¦å’Œè´Ÿè½½å‡è¡¡
- å®ä¾‹æ•…éšœæ¢å¤

### 3. test_docker_tools.py - Dockerå·¥å…·æµ‹è¯•

**åŠŸèƒ½**: ä¸“é—¨æµ‹è¯•Dockerç¯å¢ƒä¸‹çš„å·¥å…·åŠŸèƒ½
**ç‰¹è‰²**:
- Dockerå®¹å™¨å¥åº·æ£€æŸ¥
- éš”ç¦»æ¨¡å¼éªŒè¯
- ç½‘ç»œè¿æ¥æµ‹è¯•

### 4. test_stress.py - å‹åŠ›æµ‹è¯•

**åŠŸèƒ½**: æµ‹è¯•é›†ç¾¤åœ¨é«˜è´Ÿè½½ä¸‹çš„æ€§èƒ½è¡¨ç°
**æµ‹è¯•é¡¹**:
- å¹¶å‘ä»»åŠ¡å¤„ç†èƒ½åŠ›
- èµ„æºä½¿ç”¨æƒ…å†µç›‘æ§
- æ•…éšœæ¢å¤æ—¶é—´æµ‹è¯•

## ğŸ­ æ¼”ç¤ºè„šæœ¬è¯´æ˜

### demo_complete.py - å®Œæ•´åŠŸèƒ½æ¼”ç¤º

å±•ç¤ºæ‰€æœ‰ä¸»è¦åŠŸèƒ½çš„å®Œæ•´å·¥ä½œæµç¨‹ï¼š

1. **è¿æ¥åˆå§‹åŒ–**: å»ºç«‹ä¸é›†ç¾¤çš„è¿æ¥
2. **å·¥å…·å‘ç°**: è·å–æ‰€æœ‰å¯ç”¨å·¥å…·åˆ—è¡¨
3. **ç½‘é¡µå¯¼èˆª**: è®¿é—®å¤šä¸ªç½‘ç«™
4. **é¡µé¢æ“ä½œ**: æˆªå›¾ã€å¿«ç…§ã€å†…å®¹è·å–
5. **æ ‡ç­¾é¡µç®¡ç†**: åˆ›å»ºã€åˆ‡æ¢ã€å…³é—­æ ‡ç­¾é¡µ
6. **ç½‘ç»œç›‘æ§**: è·å–è¯·æ±‚å’Œæ§åˆ¶å°ä¿¡æ¯
7. **çª—å£æ§åˆ¶**: è°ƒæ•´å¤§å°ã€å¯¼èˆªå†å²
8. **èµ„æºæ¸…ç†**: å®‰å…¨å…³é—­è¿æ¥

### demo_simple.py - ç®€å•æ¼”ç¤º

åŸºç¡€åŠŸèƒ½å¿«é€Ÿæ¼”ç¤ºï¼Œé€‚åˆå…¥é—¨ç”¨æˆ·ã€‚

## ğŸ³ Dockeré›†æˆ

### Dockerfile è§£æ

```dockerfile
# å¤šé˜¶æ®µæ„å»ºï¼Œä¼˜åŒ–é•œåƒå¤§å°
FROM node:22-bookworm-slim AS base

# å®‰è£…ç³»ç»Ÿä¾èµ–
RUN apt-get update && apt-get install -y \
    python3 python3-pip python3-venv \
    curl wget ca-certificates

# å®‰è£…Playwrightæµè§ˆå™¨
FROM base AS browser
RUN npx -y playwright-core install chromium && \
    npx -y playwright-core install chrome

# ç”Ÿäº§é•œåƒ
FROM base
# å¤åˆ¶æµè§ˆå™¨æ–‡ä»¶å’Œåº”ç”¨ä»£ç 
COPY --from=browser ${PLAYWRIGHT_BROWSERS_PATH} ${PLAYWRIGHT_BROWSERS_PATH}
COPY --from=builder /app/lib /app/lib

# æ”¯æŒéš”ç¦»æ¨¡å¼å¯åŠ¨
ENTRYPOINT ["node", "cli.js", "--headless", "--browser", "chromium", "--isolated"]
```

### Dockeré›†ç¾¤å¯åŠ¨è¿‡ç¨‹

1. **é•œåƒæ„å»º**: åˆ›å»ºåŒ…å«æ‰€æœ‰ä¾èµ–çš„Dockeré•œåƒ
2. **å®¹å™¨å¯åŠ¨**: ä¸ºæ¯ä¸ªå®ä¾‹å¯åŠ¨ç‹¬ç«‹å®¹å™¨
3. **ç½‘ç»œé…ç½®**: æ˜ å°„ç«¯å£åˆ°ä¸»æœº
4. **ç¯å¢ƒéš”ç¦»**: è®¾ç½®ç‹¬ç«‹çš„ç¯å¢ƒå˜é‡
5. **å¥åº·æ£€æŸ¥**: éªŒè¯å®¹å™¨è¿è¡ŒçŠ¶æ€

## ğŸ“Š ç›‘æ§å’Œæ—¥å¿—

### æ—¥å¿—ç³»ç»Ÿ
```
logs/
â”œâ”€â”€ mcp-mcp-1.log      # å®ä¾‹1æ—¥å¿—
â”œâ”€â”€ mcp-mcp-2.log      # å®ä¾‹2æ—¥å¿—
â”œâ”€â”€ mcp-mcp-3.log      # å®ä¾‹3æ—¥å¿—
â”œâ”€â”€ mcp-mcp-4.log      # å®ä¾‹4æ—¥å¿—
â””â”€â”€ mcp-mcp-5.log      # å®ä¾‹5æ—¥å¿—
```

### ç›‘æ§æŒ‡æ ‡
- **å®ä¾‹çŠ¶æ€**: å¥åº·ã€ä¸å¥åº·ã€é”™è¯¯
- **ä»»åŠ¡ç»Ÿè®¡**: å®Œæˆæ•°ã€å¤±è´¥æ•°ã€é˜Ÿåˆ—å¤§å°
- **æ€§èƒ½æŒ‡æ ‡**: å“åº”æ—¶é—´ã€èµ„æºä½¿ç”¨ç‡
- **é”™è¯¯è¿½è¸ª**: è¯¦ç»†çš„é”™è¯¯æ—¥å¿—å’Œå †æ ˆè·Ÿè¸ª

## ğŸš¨ æ•…éšœæ’é™¤æŒ‡å—

### å¸¸è§é—®é¢˜åŠè§£å†³æ–¹æ¡ˆ

#### 1. ç«¯å£å†²çª
```bash
# æ£€æŸ¥ç«¯å£å ç”¨
lsof -i :9001-9005

# è§£å†³æ–¹æ¡ˆ
./stop.sh  # åœæ­¢æ‰€æœ‰å®ä¾‹
```

#### 2. Dockeræƒé™é—®é¢˜
```bash
# æ£€æŸ¥DockerçŠ¶æ€
docker version
sudo systemctl status docker

# è§£å†³æ–¹æ¡ˆ
sudo systemctl start docker
sudo usermod -aG docker $USER
```

#### 3. æµè§ˆå™¨å®‰è£…å¤±è´¥
```bash
# æ£€æŸ¥æµè§ˆå™¨å®‰è£…
npx playwright install --dry-run

# è§£å†³æ–¹æ¡ˆ
npx playwright install chrome
```

#### 4. å†…å­˜ä¸è¶³
```bash
# æ£€æŸ¥å†…å­˜ä½¿ç”¨
free -h
docker stats

# è§£å†³æ–¹æ¡ˆ
# 1. å‡å°‘å®ä¾‹æ•°é‡
# 2. å¢åŠ ç³»ç»Ÿå†…å­˜
# 3. ä¼˜åŒ–æµè§ˆå™¨å‚æ•°
```

### è°ƒè¯•æ¨¡å¼

#### å¯ç”¨è¯¦ç»†æ—¥å¿—
```bash
# æœ¬åœ°æ¨¡å¼è°ƒè¯•
DEBUG=1 ./start.sh

# Dockeræ¨¡å¼è°ƒè¯•
docker logs -f mcp-instance-1
```

#### æ€§èƒ½åˆ†æ
```bash
# æŸ¥çœ‹å®ä¾‹æ€§èƒ½
python3 -c "
import psutil
for proc in psutil.process_iter(['pid', 'name', 'memory_percent']):
    if 'playwright' in proc.info['name'].lower():
        print(f'PID: {proc.info[\"pid\"]}, Memory: {proc.info[\"memory_percent\"]:.1f}%')
"
```

## ğŸ”„ ç‰ˆæœ¬å‡çº§æŒ‡å—

### ä»å•å®ä¾‹è¿ç§»åˆ°é›†ç¾¤

1. **å¤‡ä»½ç°æœ‰é…ç½®**
```bash
cp ~/.cache/ms-playwright ~/.cache/ms-playwright.backup
```

2. **å®‰è£…é›†ç¾¤ç‰ˆæœ¬**
```bash
git clone <repository>
cd playwright-mcp
```

3. **é…ç½®é›†ç¾¤**
```bash
# ç¼–è¾‘é…ç½®æ–‡ä»¶
vim cluster_config.json

# å¯åŠ¨é›†ç¾¤
./start.sh
```

4. **éªŒè¯è¿ç§»**
```bash
python3 test_cluster_management.py
```

### å‡çº§æ£€æŸ¥æ¸…å•
- [ ] é…ç½®æ–‡ä»¶å…¼å®¹æ€§
- [ ] ç«¯å£å¯ç”¨æ€§
- [ ] Dockerç¯å¢ƒå‡†å¤‡
- [ ] æµè§ˆå™¨ä¾èµ–å®‰è£…
- [ ] ç½‘ç»œè¿æ¥æµ‹è¯•

## ğŸ“ˆ æ€§èƒ½ä¼˜åŒ–å»ºè®®

### 1. ç¡¬ä»¶é…ç½®
- **CPU**: æ¯ä¸ªå®ä¾‹å»ºè®®1æ ¸å¿ƒï¼Œæ¨è4æ ¸å¿ƒä»¥ä¸Š
- **å†…å­˜**: æ¯ä¸ªå®ä¾‹çº¦500MBï¼Œæ¨è8GBä»¥ä¸Š
- **å­˜å‚¨**: SSDæ¨èï¼Œè‡³å°‘10GBå¯ç”¨ç©ºé—´

### 2. ç½‘ç»œä¼˜åŒ–
- ä½¿ç”¨ç¨³å®šçš„ç½‘ç»œè¿æ¥
- é…ç½®ä»£ç†æœåŠ¡å™¨ï¼ˆå¦‚éœ€è¦ï¼‰
- è°ƒæ•´è¶…æ—¶å‚æ•°

### 3. æµè§ˆå™¨ä¼˜åŒ–
```bash
# å¯åŠ¨å‚æ•°ä¼˜åŒ–
--no-sandbox
--disable-dev-shm-usage
--disable-gpu
--disable-extensions
```

### 4. é›†ç¾¤è°ƒä¼˜
- æ ¹æ®ç¡¬ä»¶èµ„æºè°ƒæ•´å®ä¾‹æ•°é‡
- åˆç†è®¾ç½®å¹¶å‘é™åˆ¶
- ä¼˜åŒ–å¥åº·æ£€æŸ¥é—´éš”

## ğŸ¯ æœ€ä½³å®è·µ

### 1. é›†ç¾¤è§„åˆ’
- æ ¹æ®ä¸šåŠ¡éœ€æ±‚ç¡®å®šå®ä¾‹æ•°é‡
- é¢„ç•™20%çš„èµ„æºä½™é‡
- åˆ¶å®šæ‰©å®¹å’Œç¼©å®¹ç­–ç•¥

### 2. ç›‘æ§å‘Šè­¦
```bash
# è®¾ç½®ç›‘æ§è„šæœ¬
#!/bin/bash
UNHEALTHY=$(python3 -c "
from mcp_manager_sse import MCPManager
manager = MCPManager()
status = manager.get_status()
print(sum(1 for inst in status['instances'].values() if inst['status'] != 'healthy'))
")

if [ $UNHEALTHY -gt 0 ]; then
    echo "Warning: $UNHEALTHY instances unhealthy"
    # å‘é€å‘Šè­¦é€šçŸ¥
fi
```

### 3. å®šæœŸç»´æŠ¤
- æ¯æ—¥æ£€æŸ¥æ—¥å¿—æ–‡ä»¶å¤§å°
- æ¯å‘¨æ¸…ç†ä¸´æ—¶æ–‡ä»¶
- æ¯æœˆæ›´æ–°æµè§ˆå™¨ç‰ˆæœ¬

### 4. å®‰å…¨è€ƒè™‘
- é™åˆ¶ç½‘ç»œè®¿é—®èŒƒå›´
- å®šæœŸæ›´æ–°ä¾èµ–ç‰ˆæœ¬
- ç›‘æ§å¼‚å¸¸è®¿é—®è¡Œä¸º

## ğŸ“š æ‰©å±•å¼€å‘

### è‡ªå®šä¹‰å·¥å…·å¼€å‘
```python
def custom_tool(client: SSEClient, params: dict):
    """è‡ªå®šä¹‰å·¥å…·ç¤ºä¾‹"""
    try:
        result = client.call_tool('browser_evaluate', {
            'script': f'custom_function({params})'
        })
        return {'success': True, 'data': result}
    except Exception as e:
        return {'success': False, 'error': str(e)}
```

### é›†ç¾¤ç®¡ç†æ‰©å±•
```python
class CustomMCPManager(MCPManager):
    """æ‰©å±•çš„é›†ç¾¤ç®¡ç†å™¨"""
    
    def add_custom_monitoring(self):
        """æ·»åŠ è‡ªå®šä¹‰ç›‘æ§åŠŸèƒ½"""
        pass
    
    def implement_load_balancing(self):
        """å®ç°è´Ÿè½½å‡è¡¡ç®—æ³•"""
        pass
```

## ğŸ¤ è´¡çŒ®æŒ‡å—

### å¼€å‘ç¯å¢ƒè®¾ç½®
```bash
# å…‹éš†é¡¹ç›®
git clone <repository>
cd playwright-mcp

# å®‰è£…ä¾èµ–
npm install
pip3 install -r python/requirements.txt

# è¿è¡Œæµ‹è¯•
python3 test_cluster_management.py
```

### æäº¤è§„èŒƒ
- åŠŸèƒ½å¼€å‘ï¼š`feat: æ·»åŠ æ–°åŠŸèƒ½`
- é”™è¯¯ä¿®å¤ï¼š`fix: ä¿®å¤æŸä¸ªé—®é¢˜`
- æ–‡æ¡£æ›´æ–°ï¼š`docs: æ›´æ–°æ–‡æ¡£`
- æµ‹è¯•ç›¸å…³ï¼š`test: æ·»åŠ æµ‹è¯•ç”¨ä¾‹`

---

**ğŸ“ å¦‚éœ€æ›´å¤šå¸®åŠ©ï¼Œè¯·æŸ¥çœ‹ä¸»æ–‡æ¡£æˆ–æäº¤Issueï¼** 

## ğŸ”„ å·¥ä½œæµç¨‹ä¼˜åŒ–

### å¼€å‘å·¥ä½œæµ
```bash
# 1. å¯åŠ¨å¼€å‘ç¯å¢ƒ
./start.sh --docker

# 2. è¿è¡Œæµ‹è¯•
python3 test_all_tools_chinese.py

# 3. æŸ¥çœ‹æ—¥å¿—ï¼ˆå¦‚æœ‰é—®é¢˜ï¼‰
tail -f logs/mcp-*.log

# 4. åœæ­¢å¹¶æ¸…ç†
./stop.sh --force
```

### ç”Ÿäº§éƒ¨ç½²å·¥ä½œæµ
```bash
# 1. æ„å»ºç”Ÿäº§é•œåƒ
docker build -t playwright-mcp:prod .

# 2. å¯åŠ¨ç”Ÿäº§é›†ç¾¤
./start.sh --docker --config production_config.json

# 3. éªŒè¯é›†ç¾¤çŠ¶æ€
python3 test_cluster_management.py

# 4. ç›‘æ§æ—¥å¿—
tail -f logs/mcp-*.log
```

### ç»´æŠ¤å·¥ä½œæµ
```bash
# 1. æ£€æŸ¥å½“å‰çŠ¶æ€
./stop.sh  # ä»…æ˜¾ç¤ºçŠ¶æ€ï¼Œä¸åœæ­¢

# 2. é€‰æ‹©æ€§é‡å¯
./stop.sh --local && ./start.sh --config cluster_config.json

# 3. å®Œæ•´ç³»ç»Ÿé‡å¯
./stop.sh --force && ./start.sh --docker

# 4. æ¸…ç†å†å²æ•°æ®
./stop.sh --force  # åŒ…å«æ—¥å¿—æ¸…ç†
```

### æ•…éšœæ’é™¤å·¥ä½œæµ
```bash
# 1. å¿«é€Ÿè¯Šæ–­
./stop.sh  # æŸ¥çœ‹å½“å‰å®ä¾‹çŠ¶æ€
docker ps --filter name=mcp-instance  # æ£€æŸ¥Dockerå®¹å™¨
lsof -i :9001-9005  # æ£€æŸ¥ç«¯å£å ç”¨

# 2. æ—¥å¿—åˆ†æ
tail -f logs/mcp-*.log  # æŸ¥çœ‹å®æ—¶æ—¥å¿—
docker logs mcp-instance-1  # æŸ¥çœ‹å®¹å™¨æ—¥å¿—

# 3. å¼ºåˆ¶é‡ç½®
./stop.sh --force  # å½»åº•æ¸…ç†
./start.sh --docker  # é‡æ–°å¯åŠ¨

# 4. éªŒè¯ä¿®å¤
python3 test_all_tools_chinese.py  # è¿è¡Œæµ‹è¯•
``` 